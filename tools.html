<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>2FA分享链接生成工具</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7f9fb; margin: 0; padding: 0; }
    .container { max-width: 420px; margin: 48px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 12px #eee; padding: 32px 24px; }
    h2 { color: #2196F3; margin-bottom: 24px; }
    label { display: block; margin: 18px 0 6px 0; color: #555; }
    input[type="text"] { width: 100%; padding: 8px 10px; font-size: 1.1em; border: 1px solid #d0d7de; border-radius: 8px; background: #f5f7fa; }
    input[type="checkbox"] { margin-right: 6px; }
    .row { margin-bottom: 16px; }
    #result { margin-top: 24px; word-break: break-all; background: #f5f7fa; border-radius: 8px; padding: 12px; font-size: 1.05em; }
    #copyBtn { margin-top: 10px; padding: 6px 18px; font-size: 1em; background: #2196F3; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    #copyTip { display:none; color: #2196F3; margin-left: 12px; }
    .error-row { margin-top: 10px; }
  </style>
</head>
<body>
<div class="container">
  <h2>2FA分享链接生成工具</h2>
  <div class="row">
    <label for="secret">密钥</label>
    <input type="text" id="secret" placeholder="如：JBSWY3DPEHPK3PXP">
  </div>
  <div class="row">
    <label for="title">标题</label>
    <input type="text" id="title" placeholder="如：Google">
  </div>
  <div class="row">
    <label>
      <input type="checkbox" id="readonly">
      分享模式（密钥不可编辑）
    </label>
  </div>
  <div class="error-row" id="errorRow" style="display:none;">
    <label>
      <input type="checkbox" id="xy">
      ERROR
    </label>
  </div>
  <div id="result"></div>
  <button id="copyBtn">复制链接</button><span id="copyTip">已复制</span>
</div>
<script>
  function getParam(name) {
    return location.search.indexOf(name + '=') !== -1 || location.search.indexOf('?' + name) !== -1;
  }
  // 是否显示ERROR标签
  if (getParam('admin')) {
    document.getElementById('errorRow').style.display = '';
  }

  function genLink() {
    const base = 'https://2fa.7so.top';
    const secret = encodeURIComponent(document.getElementById('secret').value.trim());
    const title = encodeURIComponent(document.getElementById('title').value.trim());
    const readonly = document.getElementById('readonly').checked;
    const xy = document.getElementById('xy') && document.getElementById('xy').checked;
    let params = [];
    if (secret) params.push('code=' + secret);
    if (title) params.push('bt=' + title);
    if (readonly) params.push('xg=f');
    if (xy) params.push('xy=t');
    const url = base + (params.length ? '?' + params.join('&') : '');
    document.getElementById('result').textContent = url;
    return url;
  }

  document.getElementById('secret').addEventListener('input', genLink);
  document.getElementById('title').addEventListener('input', genLink);
  document.getElementById('readonly').addEventListener('change', genLink);
  if (document.getElementById('xy')) {
    document.getElementById('xy').addEventListener('change', genLink);
  }
  genLink();

  document.getElementById('copyBtn').onclick = function() {
    const url = genLink();
    navigator.clipboard.writeText(url).then(function() {
      document.getElementById('copyTip').style.display = 'inline';
      setTimeout(function() {
        document.getElementById('copyTip').style.display = 'none';
      }, 1000);
    });
  };
</script>
</body>
</html>